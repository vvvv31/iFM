<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>英语课程节目列表 - 英语学习中心</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="../js/search.js"></script>
    <style>
        /* 节目列表页面专用样式 */
        .program-main {
            background-color: #fff;
            min-height: calc(100vh - 66px - 84px);
            padding: 30px 0;
        }
        
        .program-layout {
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
        }
        
        /* 主内容区 */
        .program-content {
            flex: 1;
            min-width: 300px;
        }
        
        /* 课程封面和标题区域 */
        .program-header {
            display: flex;
            gap: 30px;
            background-color: #FFF8DC;
            border: 1px solid #FFDAB9;
            border-radius: 8px;
            padding: 30px;
            margin-bottom: 20px;
        }
        
        .program-cover {
            flex-shrink: 0;
        }
        
        .cover-image {
            width: 300px;
            height: 200px;
            object-fit: cover;
            border-radius: 8px;
            border: 2px solid #FF8C00;
            background-color: #E0FFFF;
        }
        
        .program-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        
        .program-title {
            font-size: 24px;
            font-weight: 700;
            color: #000;
            margin-bottom: 15px;
            line-height: 1.3;
            position: relative;
            padding-bottom: 10px;
        }
        
        .program-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 2px;
            background-color: #FF8C00;
            border-radius: 1px;
        }
        
        .program-meta {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .meta-item {
            background-color: #fff8e1;
            color: #FF8C00;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 13px;
            font-weight: 500;
            border: 1px solid #FFDAB9;
        }
        
        .program-stats {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            color: #666;
            font-size: 14px;
            flex-wrap: wrap;
        }
        
        .program-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            padding: 10px 24px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            outline: none;
        }
        
        .btn-primary {
            background-color: #FF8C00;
            color: white;
            border: 1px solid #FF8C00;
        }
        
        .btn-primary:hover {
            background-color: #ff7000;
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background-color: #fff3e0;
            color: #FF8C00;
            border: 1px solid #FFDAB9;
        }
        
        .btn-secondary:hover {
            background-color: #ffe0b2;
            transform: translateY(-1px);
        }
        
        .btn-outline {
            background-color: transparent;
            color: #FF8C00;
            border: 1px solid #FF8C00;
        }
        
        .btn-outline:hover {
            background-color: #fff8e1;
            transform: translateY(-1px);
        }
        
        /* 标签导航 */
        .program-tabs {
            background-color: #FFF8DC;
            border: 1px solid #FFDAB9;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .tab-container {
            display: flex;
            border-bottom: 1px solid #FFDAB9;
        }
        
        .tab-btn {
            padding: 15px 25px;
            background: none;
            border: none;
            font-size: 14px;
            font-weight: 500;
            color: #666;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .tab-btn:hover {
            color: #FF8C00;
            background-color: #FFEDCC;
        }
        
        .tab-btn.active {
            color: #FF8C00;
            font-weight: 600;
        }
        
        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: #FF8C00;
        }
        
        /* 标签内容 */
        .tab-content {
            background-color: #fff;
            border-radius: 0 0 8px 8px;
            padding: 25px;
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* 详情部分样式 */
        .detail-section {
            margin-bottom: 25px;
        }
        
        .detail-section h2 {
            font-size: 18px;
            font-weight: 600;
            color: #000;
            margin-bottom: 15px;
            position: relative;
            padding-left: 12px;
        }
        
        .detail-section h2::before {
            content: '';
            position: absolute;
            left: 0;
            top: 5px;
            bottom: 5px;
            width: 4px;
            background-color: #FF8C00;
            border-radius: 2px;
        }
        
        .detail-section p {
            margin-bottom: 15px;
            color: #333;
            line-height: 1.6;
            text-align: justify;
            word-break: break-word;
        }
        
        .detail-section ul {
            margin-bottom: 15px;
            padding-left: 20px;
        }
        
        .detail-section li {
            margin-bottom: 8px;
            color: #333;
            position: relative;
            padding-left: 10px;
        }
        
        .detail-section li::before {
            content: '•';
            color: #FF8C00;
            font-weight: bold;
            position: absolute;
            left: -10px;
        }
        
        /* 课程大纲样式 */
        .syllabus-section h2 {
            font-size: 18px;
            font-weight: 600;
            color: #000;
            margin-bottom: 20px;
        }
        
        .unit-item {
            margin-bottom: 20px;
            background-color: #fafafa;
            border: 1px solid #FFDAB9;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .unit-header {
            background-color: #fff3e0;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: background-color 0.3s ease;
            border-bottom: 1px solid #FFDAB9;
        }
        
        .unit-header:hover {
            background-color: #ffe0b2;
        }
        
        .unit-header h3 {
            font-size: 16px;
            font-weight: 600;
            color: #000;
            margin: 0;
        }
        
        .unit-duration {
            font-size: 13px;
            color: #FF8C00;
            font-weight: 500;
        }
        
        .lesson-list {
            padding: 10px 0;
        }
        
        .lesson-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 20px;
            transition: background-color 0.3s ease;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .lesson-item:last-child {
            border-bottom: none;
        }
        
        .lesson-item:hover {
            background-color: #FFF8DC;
        }
        
        .lesson-info {
            display: flex;
            align-items: center;
            gap: 15px;
            flex: 1;
        }
        
        .lesson-number {
            font-size: 14px;
            font-weight: 600;
            color: #FF8C00;
            min-width: 30px;
        }
        
        .lesson-title {
            font-size: 14px;
            color: #000;
        }
        
        .lesson-duration {
            font-size: 13px;
            color: #666;
            margin-right: 15px;
        }
        
        .play-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: #fff;
            border: 1px solid #FF8C00;
            color: #FF8C00;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }
        
        .play-btn:hover {
            background-color: #FF8C00;
            color: #fff;
            transform: scale(1.05);
        }
        
        /* 课程章节侧边栏样式 */
        .chapter-sidebar {
            width: 320px;
            flex-shrink: 0;
            background: white;
            border: 1px solid #FFDAB9;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .chapter-header {
            background-color: #FF8C00;
            color: white;
            padding: 12px 15px;
            font-size: 14px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .chapter-header h2 {
            margin: 0;
            font-size: 16px;
        }
        
        .back-button {
            background: none;
            border: none;
            color: white;
            font-size: 16px;
            cursor: pointer;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .chapter-list {
            background-color: #f9f9f9;
        }
        
        .chapter-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .chapter-item:last-child {
            border-bottom: none;
        }
        
        .chapter-item.active {
            background-color: #fff0e0;
        }
        
        .chapter-number {
            color: #FF8C00;
            font-weight: 600;
            margin-right: 10px;
            font-size: 14px;
            min-width: 20px;
        }
        
        .chapter-content {
            flex: 1;
            min-width: 0;
        }
        
        .chapter-title {
            font-size: 14px;
            color: #333;
            margin: 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .chapter-duration {
            color: #FF8C00;
            font-size: 14px;
            margin-left: 10px;
            font-weight: 500;
        }
        
        /* 页脚样式 */
        .footer {
            background-color: #fff;
            padding: 30px 0;
            border-top: 1px solid #FFDAB9;
            margin-top: 40px;
        }
        
        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .footer-info p {
            color: #666;
            font-size: 14px;
            margin: 0;
        }
        
        .footer-links {
            display: flex;
            gap: 20px;
        }
        
        .footer-link {
            text-decoration: none;
            color: #666;
            font-size: 14px;
            transition: color 0.3s ease;
        }
        
        .footer-link:hover {
            color: #FF8C00;
        }
        
        /* 响应式设计 */
        @media (max-width: 1024px) {
            .program-layout {
                flex-direction: column;
            }
            
            .chapter-sidebar {
                width: 100%;
                max-width: none;
            }
            
            .program-title {
                font-size: 22px;
            }
            
            .program-header {
                padding: 20px;
            }
            
            .program-header {
                flex-direction: column;
                text-align: center;
            }
            
            .program-cover {
                align-self: center;
            }
            
            .cover-image {
                width: 100%;
                max-width: 400px;
                height: auto;
            }
            
            .program-actions {
                justify-content: center;
            }
        }
        
        @media (max-width: 768px) {
            .program-title {
                font-size: 20px;
            }
            
            .detail-section p {
                font-size: 14px;
            }
            
            .program-header {
                padding: 15px;
            }
            
            .tab-container {
                overflow-x: auto;
                white-space: nowrap;
            }
            
            .tab-btn {
                padding: 12px 20px;
                font-size: 13px;
            }
            
            .tab-content {
                padding: 20px;
            }
            
            .footer-content {
                flex-direction: column;
                text-align: center;
            }
            
            .footer-links {
                flex-wrap: wrap;
                justify-content: center;
            }
        }
        
        @media (max-width: 480px) {
            .program-header {
                padding: 15px;
            }
            
            .program-title {
                font-size: 18px;
            }
            
            .program-info {
                align-items: flex-start;
            }
            
            .program-stats {
                flex-direction: column;
                gap: 8px;
            }
            
            .program-meta {
                flex-wrap: wrap;
                gap: 8px;
            }
            
            .program-actions {
                flex-wrap: wrap;
                gap: 10px;
            }
            
            .action-btn {
                padding: 8px 16px;
                font-size: 13px;
                flex: 1;
                min-width: 120px;
            }
            
            .tab-content {
                padding: 15px;
            }
            
            .detail-section h2 {
                font-size: 16px;
            }
            
            .lesson-item {
                padding: 10px 15px;
                flex-wrap: wrap;
            }
        }

        /* 为固定播放栏预留空间 */
        body { padding-bottom: 96px; }

        /* PlayBar（来自 PlayBar.html）样式 */
        .pv-player-bar { position: fixed; left:0; right:0; bottom:0; width:100%; height:96px; background:#ffffff; border-top:1px solid #e0e0e0; box-shadow:0 -4px 20px rgba(0,0,0,0.08); z-index:29999; display:flex; align-items:center; user-select:none; pointer-events:auto; }
        .pv-inner { width:100%; max-width:1200px; margin:0 auto; display:grid; grid-template-columns:auto 1fr auto; align-items:center; column-gap:16px; padding:0 24px; height:100%; }
        .pv-left { display:inline-flex; align-items:center; gap:12px; min-width:240px; }
        .pv-cover { width:52px; height:52px; border-radius:8px; background:#eee no-repeat center/cover; box-shadow:0 2px 6px rgba(0,0,0,0.1); flex-shrink:0; }
        .pv-meta { display:flex; flex-direction:column; min-width:0; }
        .pv-title { font-size:16px; font-weight:700; color:#222; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
        .pv-artist { font-size:12px; color:#666; margin-top:2px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
        .pv-center { display:flex; flex-direction:column; align-items:center; justify-content:center; gap:8px; min-width:0; }
        .pv-controls { display:inline-flex; align-items:center; gap:18px; }
        .ctrl-btn, .mode-btn, .rate-btn { background:transparent; border:none; cursor:pointer; color:#444; font-size:18px; padding:6px; display:inline-flex; align-items:center; justify-content:center; transition:color 0.2s; }
        .ctrl-btn:hover, .mode-btn:hover, .rate-btn:hover { color:#ff8c00; }
        .play-btn { width:44px; height:44px; border-radius:50%; background:#ff8c00; color:#fff; border:none; display:inline-flex; align-items:center; justify-content:center; cursor:pointer; box-shadow:0 4px 10px rgba(255,140,0,0.30); transition:transform 0.1s, background 0.2s; }
        .play-btn:hover { background:#e67e00; transform:scale(1.05); }
        .icon { width:18px; height:18px; fill:currentColor; }
        .pv-progress-row { display:flex; align-items:center; gap:12px; width:100%; }
        .time.small { font-size:12px; color:#888; width:48px; text-align:center; font-variant-numeric:tabular-nums; }
        .pv-progress { position:relative; flex:1; height:6px; background:#eee; border-radius:3px; cursor:pointer; touch-action:none; }
        .pv-progress-fill { position:absolute; left:0; top:0; bottom:0; background:#ff8c00; border-radius:3px; width:0%; pointer-events:none; }
        .pv-knob { position:absolute; top:50%; right:-6px; transform:translateY(-50%); width:12px; height:12px; background:#fff; border:2px solid #ff8c00; border-radius:50%; box-shadow:0 1px 4px rgba(0,0,0,0.2); opacity:0; transition:opacity 0.2s; pointer-events:none; }
        .pv-progress:hover .pv-knob, .pv-progress.dragging .pv-knob { opacity:1; }
        .pv-right { display:inline-flex; align-items:center; justify-content:flex-end; gap:12px; min-width:240px; }
        .pv-volume { width:140px; height:20px; display:flex; align-items:center; cursor:pointer; position:relative; }
        .pv-volume-bar { width:100%; height:4px; background:#eee; border-radius:2px; position:relative; overflow:visible; pointer-events:none; }
        .pv-volume-fill { height:100%; background:#888; width:50%; border-radius:2px; position:relative; }
        .playlist-panel { background:#fff; border:1px solid #eee; border-radius:8px; box-shadow:0 8px 30px rgba(0,0,0,0.12); overflow:auto; padding:8px; position:absolute; bottom:110px; right:24px; display:none; }
        .playlist-item { padding:8px 12px; cursor:pointer; }
        .playlist-item.active { background:#fff3e0; color:#ff8c00; font-weight:600; }
        @media (max-width:900px){ .pv-left{min-width:0;} .pv-right{min-width:0;} .pv-inner{grid-template-columns:auto 1fr auto; column-gap:10px; padding:0 12px;} }
    </style>
</head>
<body>
    <!-- 音频元素 -->
    <audio id="audioPlayer" controls style="display: none;">
        <source src="" type="audio/mpeg">
        您的浏览器不支持音频播放
    </audio>

    <!-- 顶部导航栏 -->
    <header class="header">
        <div class="logo">
            <div class="logo-img"></div>
            <span class="logo-text">星之声</span>
        </div>
        <nav class="main-nav">
            <a href="index.html" class="nav-item">首页</a>
            <a href="category.html" class="nav-item">分类</a>
            <a href="channel.html" class="nav-item">社区</a>
        </nav>
        <div class="search-box">
            <input type="text" placeholder="搜索课程、频道..." class="search-input" id="homeSearchInput">
            <button class="search-btn" id="homeSearchBtn"><i class="fas fa-search"></i></button>
        </div>
        <div class="user-functions">
            <a href="my-recent.html" class="func-item">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                </svg>
            </a>
            <a href="my-message.html" class="func-item"><i class="fas fa-bell"></i> 消息</a>
            <a href="my-collect.html" class="func-item"><i class="fas fa-star"></i> 收藏</a>
            <a href="my-recent.html" class="func-item"><i class="fas fa-history"></i> 历史</a>
            <a href="my-creator_center.html" class="func-item"><i class="fas fa-pen"></i> 创作中心</a>
            <a href="login.html"><button class="submit-btn">登录/注册</button></a>
        </div>
    </header>

    <!-- 主要内容区域 -->
    <main class="main-content program-main">
        <div class="program-layout">
            <!-- 左侧主内容区 -->
            <section class="program-content">
                <!-- 课程封面和标题 -->
                <div class="program-header">
                    <div class="program-cover">
                        <div class="cover-image"></div>
                    </div>
                    <div class="program-info">
                        <h1 class="program-title">英语日常对话系列</h1>
                        <div class="program-meta">
                            <span class="meta-item">初级到中级</span>
                            <span class="meta-item">共20集</span>
                            <span class="meta-item">已完结</span>
                        </div>
                        <div class="program-stats">
                            <span class="stat-item">播放量：12.5万</span>
                            <span class="stat-item">评分：4.9</span>
                            <span class="stat-item">学习人数：5.8万</span>
                        </div>
                        <div class="program-actions">
                            <button class="action-btn btn-primary" onclick="window.location.href='player.html'">立即学习</button>
                            <button class="action-btn btn-secondary">加入收藏</button>
                            <button class="action-btn btn-outline">分享课程</button>
                        </div>
                    </div>
                </div>
                
                <!-- 标签导航 -->
                <div class="program-tabs">
                    <div class="tab-container">
                        <button class="tab-btn active">课程详情</button>
                        <button class="tab-btn">课程大纲</button>
                        <button class="tab-btn">学员评价</button>
                        <button class="tab-btn">常见问题</button>
                    </div>
                    
                    <!-- 课程详情内容 -->
                    <div class="tab-content active">
                        <div class="detail-section">
                            <h2>课程介绍</h2>
                            <p>本课程专为想要提升日常英语对话能力的学习者设计，从最基础的问候语到日常生活场景中的实用对话，循序渐进地帮助学习者掌握实用英语。</p>
                            <p>通过本课程的学习，您将能够：</p>
                            <ul>
                                <li>掌握日常生活中最常用的英语表达</li>
                                <li>在各种日常场景中自信地进行英语交流</li>
                                <li>提高听力理解能力和口语表达能力</li>
                                <li>学习地道的英语表达方式和文化背景知识</li>
                            </ul>
                        </div>
                        
                        <div class="detail-section">
                            <h2>适合人群</h2>
                            <ul>
                                <li>英语初级到中级水平的学习者</li>
                                <li>想要提高日常英语会话能力的学习者</li>
                                <li>即将出国旅游、学习或工作的人士</li>
                                <li>需要在日常生活中使用英语的学习者</li>
                            </ul>
                        </div>
                        
                        <div class="detail-section">
                            <h2>学习目标</h2>
                            <ul>
                                <li>能够进行基本的问候和自我介绍</li>
                                <li>掌握在餐厅、商店、机场等场所的常用对话</li>
                                <li>能够进行简单的社交和交流</li>
                                <li>理解日常对话中的基本词汇和语法</li>
                                <li>提高听力理解能力和口语表达流畅度</li>
                            </ul>
                        </div>
                        
                        <div class="detail-section">
                            <h2>课程特色</h2>
                            <ul>
                                <li>情景对话：真实生活场景中的对话练习</li>
                                <li>语音讲解：清晰的发音指导和语调练习</li>
                                <li>互动练习：丰富的练习活动巩固所学内容</li>
                                <li>文化背景：介绍英语国家的文化习俗和礼仪</li>
                                <li>实用词汇：每个场景的核心词汇和表达方式</li>
                            </ul>
                        </div>
                    </div>
                    
                    <!-- 课程大纲内容 (默认隐藏) -->
                    <div class="tab-content">
                        <div class="syllabus-section">
                            <h2>课程大纲</h2>
                            
                            <!-- 第一单元 -->
                            <div class="unit-item">
                                <div class="unit-header">
                                    <h3>第一单元：日常问候与自我介绍</h3>
                                    <span class="unit-duration">5集 · 约45分钟</span>
                                </div>
                                <div class="lesson-list">
                                    <div class="lesson-item">
                                        <div class="lesson-info">
                                            <span class="lesson-number">1.1</span>
                                            <span class="lesson-title">基础问候语</span>
                                        </div>
                                        <span class="lesson-duration">8:30</span>
                                        <button class="play-btn">
                                            <i class="fas fa-play"></i>
                                        </button>
                                    </div>
                                    <div class="lesson-item">
                                        <div class="lesson-info">
                                            <span class="lesson-number">1.2</span>
                                            <span class="lesson-title">自我介绍</span>
                                        </div>
                                        <span class="lesson-duration">10:15</span>
                                        <button class="play-btn">
                                            <i class="fas fa-play"></i>
                                        </button>
                                    </div>
                                    <div class="lesson-item">
                                        <div class="lesson-info">
                                            <span class="lesson-number">1.3</span>
                                            <span class="lesson-title">询问和回答个人信息</span>
                                        </div>
                                        <span class="lesson-duration">7:45</span>
                                        <button class="play-btn">
                                            <i class="fas fa-play"></i>
                                        </button>
                                    </div>
                                    <div class="lesson-item">
                                        <div class="lesson-info">
                                            <span class="lesson-number">1.4</span>
                                            <span class="lesson-title">谈论天气和季节</span>
                                        </div>
                                        <span class="lesson-duration">9:20</span>
                                        <button class="play-btn">
                                            <i class="fas fa-play"></i>
                                        </button>
                                    </div>
                                    <div class="lesson-item">
                                        <div class="lesson-info">
                                            <span class="lesson-number">1.5</span>
                                            <span class="lesson-title">第一单元复习与练习</span>
                                        </div>
                                        <span class="lesson-duration">9:05</span>
                                        <button class="play-btn">
                                            <i class="fas fa-play"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 第二单元 -->
                            <div class="unit-item">
                                <div class="unit-header">
                                    <h3>第二单元：在餐厅用餐</h3>
                                    <span class="unit-duration">5集 · 约50分钟</span>
                                </div>
                                <div class="lesson-list">
                                    <div class="lesson-item">
                                        <div class="lesson-info">
                                            <span class="lesson-number">2.1</span>
                                            <span class="lesson-title">预订餐厅和入座</span>
                                        </div>
                                        <span class="lesson-duration">10:30</span>
                                        <button class="play-btn">
                                            <i class="fas fa-play"></i>
                                        </button>
                                    </div>
                                    <div class="lesson-item">
                                        <div class="lesson-info">
                                            <span class="lesson-number">2.2</span>
                                            <span class="lesson-title">点餐用语</span>
                                        </div>
                                        <span class="lesson-duration">11:15</span>
                                        <button class="play-btn">
                                            <i class="fas fa-play"></i>
                                        </button>
                                    </div>
                                    <div class="lesson-item">
                                        <div class="lesson-info">
                                            <span class="lesson-number">2.3</span>
                                            <span class="lesson-title">询问菜品和特殊要求</span>
                                        </div>
                                        <span class="lesson-duration">9:45</span>
                                        <button class="play-btn">
                                            <i class="fas fa-play"></i>
                                        </button>
                                    </div>
                                    <div class="lesson-item">
                                        <div class="lesson-info">
                                            <span class="lesson-number">2.4</span>
                                            <span class="lesson-title">用餐过程中的交流</span>
                                        </div>
                                        <span class="lesson-duration">9:50</span>
                                        <button class="play-btn">
                                            <i class="fas fa-play"></i>
                                        </button>
                                    </div>
                                    <div class="lesson-item">
                                        <div class="lesson-info">
                                            <span class="lesson-number">2.5</span>
                                            <span class="lesson-title">结账和评价</span>
                                        </div>
                                        <span class="lesson-duration">8:35</span>
                                        <button class="play-btn">
                                            <i class="fas fa-play"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 学员评价内容 (默认隐藏) -->
                    <div class="tab-content">
                        <div class="detail-section">
                            <h2>学员评价</h2>
                            <p>暂无评价内容...</p>
                        </div>
                    </div>
                    
                    <!-- 常见问题内容 (默认隐藏) -->
                    <div class="tab-content">
                        <div class="detail-section">
                            <h2>常见问题</h2>
                            <p>暂无常见问题...</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- 右侧课程章节侧边栏 -->
            <aside class="chapter-sidebar">
                <div class="chapter-header">
                    <button class="back-button"><i class="fas fa-arrow-left"></i></button>
                    <h2>课程章节</h2>
                </div>
                <div class="chapter-list">
                    <div class="chapter-item active">
                        <div class="chapter-number">1.</div>
                        <div class="chapter-content">
                            <div class="chapter-title">日常对话 - 打招呼与自我介绍</div>
                        </div>
                        <div class="chapter-duration">10:35</div>
                    </div>
                    <div class="chapter-item">
                        <div class="chapter-number">2.</div>
                        <div class="chapter-content">
                            <div class="chapter-title">日常对话 - 在餐厅点餐</div>
                        </div>
                        <div class="chapter-duration">8:45</div>
                    </div>
                    <div class="chapter-item">
                        <div class="chapter-number">3.</div>
                        <div class="chapter-content">
                            <div class="chapter-title">日常对话 - 问路与交通</div>
                        </div>
                        <div class="chapter-duration">12:10</div>
                    </div>
                    <div class="chapter-item">
                        <div class="chapter-number">4.</div>
                        <div class="chapter-content">
                            <div class="chapter-title">日常对话 - 购物常用语</div>
                        </div>
                        <div class="chapter-duration">9:30</div>
                    </div>
                    <div class="chapter-item">
                        <div class="chapter-number">5.</div>
                        <div class="chapter-content">
                            <div class="chapter-title">日常对话 - 电话沟通</div>
                        </div>
                        <div class="chapter-duration">11:25</div>
                    </div>
                </div>
            </aside>
        </div>
    </main>

    <!-- 页脚 -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-info">
                    <p>© 2024 英语学习中心. 保留所有权利.</p>
                </div>
                <div class="footer-links">
                    <a href="#" class="footer-link">关于我们</a>
                    <a href="#" class="footer-link">联系方式</a>
                    <a href="#" class="footer-link">隐私政策</a>
                    <a href="#" class="footer-link">服务条款</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- 替换底部播放栏为 PlayBar.html 版本 -->
    <aside id="pv-player" class="pv-player-bar" role="region" aria-label="播放器">
      <div class="pv-inner">
        <!-- 左侧：封面与标题 -->
        <div class="pv-left">
          <div id="pv-cover" class="pv-cover"></div>
          <div class="pv-meta">
            <div id="pv-title" class="pv-title">Kalimba (Test Audio)</div>
            <div id="pv-artist" class="pv-artist">Ninja Tuna</div>
          </div>
        </div>

        <!-- 中间：控制与进度 -->
        <div class="pv-center">
          <div class="pv-controls">
            <button id="pv-prev" class="ctrl-btn" title="上一首" aria-label="上一首">
              <svg class="icon" viewBox="0 0 24 24"><path d="M6 6h2v12H6V6zm3.5 6l8.5 6V6l-8.5 6z"/></svg>
            </button>
            <button id="pv-play" class="play-btn" title="播放/暂停" aria-label="播放/暂停">
              <svg id="play-icon" class="icon" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </button>
            <button id="pv-next" class="ctrl-btn" title="下一首" aria-label="下一首">
              <svg class="icon" viewBox="0 0 24 24"><path d="M16 6h2v12h-2V6zM6 18l8.5-6L6 6v12z"/></svg>
            </button>

            <!-- 播放模式 -->
            <div style="position: relative;">
              <button id="pv-mode-btn" class="mode-btn" title="播放模式" aria-label="播放模式">
                <svg class="icon" viewBox="0 0 24 24"><path d="M7 7h8v3l4-4-4-4v3H5v6h2V7zm10 10H9v-3l-4 4 4 4v-3h10v-6h-2v4z"/></svg>
              </button>
              <div id="mode-pop" class="popover mode-popover" style="display:none;">
                <div class="mode-item active" data-mode="single" title="单曲循环">
                  <svg class="icon" viewBox="0 0 24 24"><path d="M12 5v4l-1.5-1.5C8 10 8 14 10.5 16.5S16 19 18.5 16.5L20 18c-3 3-8 3-11 0S6 9 9 6L12 5z"/></svg>
                </div>
                <div class="mode-item" data-mode="list" title="歌单顺序循环">
                  <svg class="icon" viewBox="0 0 24 24"><path d="M4 6h12v2H4V6zm0 5h12v2H4v-2zm0 5h8v2H4v-2zm15-7l-3 3h2v4h2v-4h2l-3-3z"/></svg>
                </div>
                <div class="mode-item" data-mode="shuffle" title="歌单乱序循环">
                  <svg class="icon" viewBox="0 0 24 24"><path d="M16 3h5v5h-2V6.41l-4.29 4.3-1.42-1.42L17.59 5H16V3zM4 6h7l2 2H4V6zm0 6h5l2 2H4v-2zm12 3h1.59l-2.29 2.29 1.42 1.42L20 17.41V19h2v-5h-5v2z"/></svg>
                </div>
              </div>
            </div>

            <!-- 倍速 -->
            <div class="rate-control" style="position: relative;">
              <button id="pv-rate-btn" class="rate-btn" title="倍速"><span id="rate-text" style="font-size: 12px; font-weight: bold;">1x</span></button>
              <div id="rate-pop" class="popover rate-popover" style="display:none;">
                <div class="rate-item" data-rate="0.5">0.5x</div>
                <div class="rate-item active" data-rate="1">1.0x</div>
                <div class="rate-item" data-rate="1.5">1.5x</div>
                <div class="rate-item" data-rate="2">2.0x</div>
              </div>
            </div>

            <!-- 播放列表按钮 -->
            <button id="pv-list-btn" class="ctrl-btn" title="播放列表" aria-label="播放列表">▤</button>
          </div>

          <div class="pv-progress-row">
            <span id="pv-time-cur" class="time small">00:00</span>
            <div id="pv-progress" class="pv-progress">
              <div id="pv-progress-fill" class="pv-progress-fill"></div>
              <div id="pv-knob" class="pv-knob"></div>
            </div>
            <span id="pv-time-total" class="time small">00:00</span>
          </div>
        </div>

        <!-- 右侧：音量 -->
        <div class="pv-right">
          <button id="pv-mute" class="ctrl-btn" title="静音/取消静音" aria-label="静音">
            <svg id="vol-icon" class="icon" viewBox="0 0 24 24"><path d="M3 9v6h4l5 5V4L7 9H3z"/></svg>
          </button>
          <div id="pv-volume" class="pv-volume" title="音量">
            <div class="pv-volume-bar"><div id="pv-volume-fill" class="pv-volume-fill"></div></div>
          </div>
        </div>
      </div>

      <!-- 播放列表弹窗（示例） -->
      <div id="playlist-panel" class="playlist-panel">
        <div class="playlist-item active" onclick="playIndex(0)">1. Kalimba (Test)</div>
        <div class="playlist-item" onclick="playIndex(1)">2. Sample MP3 (Test)</div>
      </div>

      <audio id="pv-audio" preload="metadata"></audio>
    </aside>

    <!-- 页面脚本：保留原页面逻辑（选项卡/章节/播放按钮） -->
    <script>
        // 课程数据
        const courseData = {
            'zero_basics': {
                title: '零基础英语入门',
                description: '从字母发音到基础对话，系统学习英语基础知识',
                level: '初级',
                lessons: '30集',
                status: '已完结',
                plays: '15.2万',
                rating: '4.9',
                learners: '8.3万',
                details: {
                    intro: '本课程专为英语零基础学习者设计，从最基础的字母发音开始，逐步过渡到单词、句子和基础对话，帮助学习者建立坚实的英语基础。',
                    goals: ['掌握26个英文字母的正确发音', '学会100个基础单词', '能够进行简单的自我介绍', '理解基础语法结构', '能够进行简单的日常对话'],
                    audience: ['英语零基础学习者', '想要重新学习英语的人士', '对英语感兴趣的任何年龄段的学员'],
                    features: ['系统化的学习路径', '清晰的发音指导', '丰富的练习活动', '实用的日常对话场景']
                }
            },
            'business_advanced': {
                title: '商务英语进阶',
                description: '掌握职场沟通技巧，提升商务英语应用能力',
                level: '中级',
                lessons: '25集',
                status: '已完结',
                plays: '9.8万',
                rating: '4.8',
                learners: '4.5万',
                details: {
                    intro: '本课程专注于商务场景中的英语应用，涵盖会议、谈判、邮件写作、演讲等职场必备技能，帮助学习者在商务环境中自信沟通。',
                    goals: ['掌握商务会议常用表达', '能够撰写专业商务邮件', '学会商务谈判技巧', '提高商务演讲能力', '了解跨文化商务礼仪'],
                    audience: ['职场人士', '商务英语学习者', '准备进入外企的求职者', '需要与国外客户沟通的专业人士'],
                    features: ['真实的商务场景', '专业的商务术语', '实用的沟通技巧', '跨文化沟通指导']
                }
            },
            'daily_conversation': {
                title: '日常口语300句',
                description: '学习最实用的日常英语表达，提升口语流利度',
                level: '初级到中级',
                lessons: '20集',
                status: '已完结',
                plays: '12.5万',
                rating: '4.9',
                learners: '5.8万',
                details: {
                    intro: '本课程精选300个最常用的日常英语表达，涵盖问候、购物、餐饮、交通等生活场景，帮助学习者在各种日常情境中流利交流。',
                    goals: ['掌握日常问候与告别', '能够在餐厅点餐交流', '学会购物时的常用表达', '能够进行简单的问路对话', '提高日常交流的流利度'],
                    audience: ['日常英语学习者', '准备出国旅游的人士', '想要提高口语能力的学习者', '需要在日常生活中使用英语的人'],
                    features: ['实用的日常表达', '真实的生活场景', '丰富的对话练习', '地道的口语用法']
                }
            },
            'listening_skills': {
                title: '英语听力技巧课',
                description: '系统训练听力理解能力，掌握听力技巧与方法',
                level: '中级',
                lessons: '15集',
                status: '已完结',
                plays: '8.3万',
                rating: '4.7',
                learners: '3.9万',
                details: {
                    intro: '本课程专注于英语听力技能的训练，通过系统的听力练习和技巧讲解，帮助学习者提高英语听力理解能力，克服听力障碍。',
                    goals: ['提高英语听力理解能力', '掌握听力预测技巧', '学会抓住关键信息', '能够理解不同口音的英语', '提高听力反应速度'],
                    audience: ['英语听力困难者', '准备英语考试的学习者', '需要提高工作听力的专业人士', '英语爱好者'],
                    features: ['循序渐进的听力训练', '多种口音的听力材料', '实用的听力技巧', '针对性的练习活动']
                }
            },
            'writing_improvement': {
                title: '英文写作提升',
                description: '学习英文写作技巧，提升书面表达能力',
                level: '中级到高级',
                lessons: '18集',
                status: '已完结',
                plays: '6.7万',
                rating: '4.8',
                learners: '3.2万',
                details: {
                    intro: '本课程专注于英文写作能力的提升，从句子结构到段落组织，从基础写作到学术写作，帮助学习者系统提高英文书面表达能力。',
                    goals: ['掌握英文句子结构', '学会段落组织方法', '能够撰写不同文体文章', '提高语法和词汇使用准确性', '培养英文写作思维'],
                    audience: ['英文写作学习者', '准备留学考试的学生', '需要英文写作的职场人士', '英文写作爱好者'],
                    features: ['系统的写作训练', '多种文体写作指导', '详细的写作修改建议', '实用的写作技巧']
                }
            },
            'business_english': {
                title: '商务英语',
                description: '职场英语技巧与商务沟通',
                level: '中级',
                lessons: '22集',
                status: '已完结',
                plays: '10.2万',
                rating: '4.8',
                learners: '4.8万',
                details: {
                    intro: '本课程专注于职场商务英语，涵盖商务沟通、会议、谈判、邮件写作等实用技能，帮助学习者在职场中自如运用英语。',
                    goals: ['掌握商务沟通基本技巧', '能够参与英语商务会议', '学会撰写专业商务邮件', '提高商务谈判能力', '了解国际商务礼仪'],
                    audience: ['职场商务人士', '外企员工', '商务英语专业学生', '需要商务英语交流的人士'],
                    features: ['真实的职场场景', '专业的商务术语', '实用的沟通策略', '国际商务文化']
                }
            },
            'daily_dialogue': {
                title: '日常对话',
                description: '生活场景英语对话练习',
                level: '初级',
                lessons: '16集',
                status: '已完结',
                plays: '9.1万',
                rating: '4.7',
                learners: '4.2万',
                details: {
                    intro: '本课程通过模拟日常生活中的各种场景，帮助学习者掌握实用的英语对话技巧，提高在日常生活中的英语交流能力。',
                    goals: ['掌握日常问候与寒暄', '能够在超市购物时交流', '学会餐厅点餐对话', '能够进行简单的社交对话', '提高日常口语流利度'],
                    audience: ['日常英语初学者', '生活英语学习者', '准备出国生活的人士', '想要提高日常交流能力的学习者'],
                    features: ['生活化场景对话', '实用的日常表达', '简单的语法讲解', '丰富的对话练习']
                }
            },
            'listening_training': {
                title: '听力训练',
                description: '英语听力理解能力专项训练',
                level: '初级到中级',
                lessons: '12集',
                status: '已完结',
                plays: '7.5万',
                rating: '4.6',
                learners: '3.5万',
                details: {
                    intro: '本课程通过系统的听力训练，帮助学习者提高英语听力理解能力，从基础听力到进阶理解，逐步提升听力水平。',
                    goals: ['提高基础听力理解', '学会捕捉关键信息', '能够理解简单对话', '提高听力反应速度', '培养英语听力习惯'],
                    audience: ['英语听力初学者', '听力困难的学习者', '准备英语考试的学生', '想要提高听力能力的人'],
                    features: ['循序渐进的训练', '多种难度的材料', '实用的听力技巧', '针对性的练习']
                }
            },
            'reading_comprehension': {
                title: '阅读理解',
                description: '英语阅读能力提升与理解技巧',
                level: '中级',
                lessons: '14集',
                status: '已完结',
                plays: '8.9万',
                rating: '4.7',
                learners: '4.1万',
                details: {
                    intro: '本课程专注于英语阅读理解能力的提升，通过精选阅读材料和技巧讲解，帮助学习者提高阅读速度和理解深度。',
                    goals: ['提高英语阅读速度', '掌握阅读理解技巧', '能够分析文章结构', '学会推断词义和句意', '提高阅读答题准确率'],
                    audience: ['英语阅读学习者', '准备英语考试的学生', '需要阅读英文资料的专业人士', '英语阅读爱好者'],
                    features: ['精选阅读材料', '系统的阅读技巧', '多种题型练习', '阅读策略指导']
                }
            }
        };

        // 获取URL参数
        function getQueryParam(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        // 根据课程ID加载课程数据
        function loadCourseData() {
            const courseId = getQueryParam('course') || 'daily_conversation'; // 默认显示日常对话课程
            const course = courseData[courseId] || courseData['daily_conversation'];

            // 更新页面标题
            document.title = `${course.title} - 英语学习中心`;

            // 更新课程标题和描述
            document.querySelector('.program-title').textContent = course.title;
            document.querySelector('.program-header').querySelector('.cover-image').style.backgroundColor = '#E0FFFF';

            // 更新元数据
            const metaContainer = document.querySelector('.program-meta');
            metaContainer.innerHTML = `
                <span class="meta-item">${course.level}</span>
                <span class="meta-item">${course.lessons}</span>
                <span class="meta-item">${course.status}</span>
            `;

            // 更新统计数据
            const statsContainer = document.querySelector('.program-stats');
            statsContainer.innerHTML = `
                <span class="stat-item">播放量：${course.plays}</span>
                <span class="stat-item">评分：${course.rating}</span>
                <span class="stat-item">学习人数：${course.learners}</span>
            `;

            // 更新课程详情
            const detailTab = document.querySelector('.tab-content.active');
            detailTab.innerHTML = `
                <div class="detail-section">
                    <h2>课程介绍</h2>
                    <p>${course.description}</p>
                    <p>${course.details.intro}</p>
                    <p>通过本课程的学习，您将能够：</p>
                    <ul>
                        ${course.details.goals.map(goal => `<li>${goal}</li>`).join('')}
                    </ul>
                </div>

                <div class="detail-section">
                    <h2>适合人群</h2>
                    <ul>
                        ${course.details.audience.map(aud => `<li>${aud}</li>`).join('')}
                    </ul>
                </div>

                <div class="detail-section">
                    <h2>课程特色</h2>
                    <ul>
                        ${course.details.features.map(feature => `<li>${feature}</li>`).join('')}
                    </ul>
                </div>
            `;

            // 更新 PlayBar 显示的标题（左下角）
            const pvTitle = document.getElementById('pv-title');
            const pvArtist = document.getElementById('pv-artist');
            if (pvTitle) pvTitle.textContent = course.title;
            if (pvArtist) pvArtist.textContent = '课程播放准备就绪';
        }

        // 页面加载时初始化
        document.addEventListener('DOMContentLoaded', function() {
            loadCourseData();

            // 保持原有的选项卡功能
            document.querySelectorAll('.tab-btn').forEach(button => {
                button.addEventListener('click', () => {
                    document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                    const tabContents = document.querySelectorAll('.tab-content');
                    const index = Array.from(button.parentElement.children).indexOf(button);
                    if (tabContents[index]) tabContents[index].classList.add('active');
                });
            });

            // 章节项点击功能
            document.querySelectorAll('.chapter-item').forEach(item => {
                item.addEventListener('click', () => {
                    document.querySelectorAll('.chapter-item').forEach(chapter => chapter.classList.remove('active'));
                    item.classList.add('active');
                });
            });

            // 播放按钮点击功能（更新 PlayBar 标题/时长）
            document.querySelectorAll('.play-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const lessonItem = button.closest('.lesson-item');
                    const lessonTitle = lessonItem.querySelector('.lesson-title').textContent;
                    const lessonDuration = lessonItem.querySelector('.lesson-duration').textContent;

                    // 更新 PlayBar 标题与总时长显示
                    const pvTitle = document.getElementById('pv-title');
                    const pvArtist = document.getElementById('pv-artist');
                    const totalEl = document.getElementById('pv-time-total');
                    if (pvTitle) pvTitle.textContent = lessonTitle;
                    if (pvArtist) pvArtist.textContent = '英语课程';
                    if (totalEl) totalEl.textContent = lessonDuration;

                    alert(`开始播放：${lessonTitle}`);
                });
            });
        });
    </script>

    <!-- PlayBar 导航与基础交互（简版） -->
    <script>
      (function () {
        const audio = document.getElementById('pv-audio');
        const playBtn = document.getElementById('pv-play');
        const progressWrap = document.getElementById('pv-progress');

        function formatTime(s) {
          if (!s || isNaN(s) || s <= 0) return '00:00';
          const m = Math.floor(s / 60), sec = Math.floor(s % 60);
          return `${String(m).padStart(2,'0')}:${String(sec).padStart(2,'0')}`;
        }

        const timeCurEl = document.getElementById('pv-time-cur');
        const timeTotalEl = document.getElementById('pv-time-total');
        const progFill = document.getElementById('pv-progress-fill');
        const pvKnob = document.getElementById('pv-knob');

        function togglePlay() {
          if (!audio) return;
          const playIcon = document.getElementById('play-icon');
          if (audio.paused) {
            audio.play().catch(()=>{});
            playBtn.setAttribute('aria-pressed','true');
            if (playIcon) playIcon.innerHTML = '<path d="M6 5h4v14H6V5zm8 0h4v14h-4V5z"/>';
          } else {
            audio.pause();
            playBtn.setAttribute('aria-pressed','false');
            if (playIcon) playIcon.innerHTML = '<path d="M8 5v14l11-7z"/>';
          }
        }
        if (playBtn) playBtn.addEventListener('click', (e) => { e.stopPropagation(); togglePlay(); });

        if (audio) {
          audio.addEventListener('timeupdate', () => {
            const dur = audio.duration || 0;
            const cur = audio.currentTime || 0;
            const pct = dur ? (cur / dur) * 100 : 0;
            if (progFill) progFill.style.width = pct + '%';
            if (pvKnob) pvKnob.style.left = pct + '%';
            if (timeCurEl) timeCurEl.textContent = formatTime(cur);
            if (timeTotalEl) timeTotalEl.textContent = formatTime(dur);
          });
          audio.addEventListener('loadedmetadata', () => {
            if (timeTotalEl) timeTotalEl.textContent = formatTime(audio.duration);
          });
          audio.addEventListener('ended', () => {
            const playIcon = document.getElementById('play-icon');
            if (playIcon) playIcon.innerHTML = '<path d="M8 5v14l11-7z"/>';
            playBtn.setAttribute('aria-pressed','false');
          });
        }

        // 点击进度条跳转
        if (progressWrap) {
          progressWrap.addEventListener('click', (e) => {
            if (!audio || !audio.duration) return;
            const rect = progressWrap.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const p = Math.max(0, Math.min(1, x / rect.width));
            audio.currentTime = p * audio.duration;
          });
        }
      })();
    </script>

    <!-- PlayBar 业务脚本（来自 PlayBar.html） -->
    <script>
    ;(function () {
      const playlist = [
        { title: "Kalimba (Test Audio)", artist: "Ninja Tuna", cover: "", src: "https://www.learningcontainer.com/wp-content/uploads/2020/02/Kalimba.mp3" },
        { title: "Sample MP3 (700KB)", artist: "Sample Source", cover: "", src: "https://sample.cat/downloads/file_example_MP3_700KB.mp3" }
      ];

      let currentIndex = 0;
      let isPlaying = false;
      let isDraggingProgress = false;
      let isDraggingVolume = false;
      let playMode = 'list'; /* single | list | shuffle */

      const audio = document.getElementById('pv-audio');
      const playBtn = document.getElementById('pv-play');
      const playIcon = document.getElementById('play-icon');
      const prevBtn = document.getElementById('pv-prev');
      const nextBtn = document.getElementById('pv-next');
      const titleEl = document.getElementById('pv-title');
      const artistEl = document.getElementById('pv-artist');
      const coverEl = document.getElementById('pv-cover');
      const progressEl = document.getElementById('pv-progress');
      const progressFill = document.getElementById('pv-progress-fill');
      const knobEl = document.getElementById('pv-knob');
      const timeCurEl = document.getElementById('pv-time-cur');
      const timeTotalEl = document.getElementById('pv-time-total');
      const volEl = document.getElementById('pv-volume');
      const volFill = document.getElementById('pv-volume-fill');
      const listBtn = document.getElementById('pv-list-btn');
      const playlistPanel = document.getElementById('playlist-panel');
      const rateBtn = document.getElementById('pv-rate-btn');
      const rateText = document.getElementById('rate-text');
      const muteBtn = document.getElementById('pv-mute');
      const volIcon = document.getElementById('vol-icon');
      const modeBtn = document.getElementById('pv-mode-btn');
      const modePop = document.getElementById('mode-pop');
      const ratePop = document.getElementById('rate-pop');

      function loadTrack(index) {
        const track = playlist[index];
        titleEl.innerText = track.title;
        artistEl.innerText = track.artist;
        coverEl.style.backgroundImage = track.cover ? `url('${track.cover}')` : '';
        audio.src = track.src;
        document.querySelectorAll('.playlist-item').forEach((item, i) => item.classList.toggle('active', i === index));
      }
      function playTrack() { audio.play().then(() => { isPlaying = true; updatePlayIcon(); }).catch(err => console.error("Play failed:", err)); }
      function pauseTrack() { audio.pause(); isPlaying = false; updatePlayIcon(); }
      function togglePlay() { isPlaying ? pauseTrack() : playTrack(); }
      function updatePlayIcon() {
        playIcon.setAttribute('viewBox','0 0 24 24');
        playIcon.innerHTML = isPlaying ? '<path d="M6 5h4v14H6V5zm8 0h4v14h-4V5z"/>' : '<path d="M8 5v14l11-7z"/>';
      }
      function formatTime(s) { if (!s || isNaN(s)) return "00:00"; const m = Math.floor(s/60), ss = Math.floor(s%60); return `${m<10?'0':''}${m}:${ss<10?'0':''}${ss}`; }
      function stopWrap(handler) { return function(e){ e.stopPropagation(); handler(e); }; }

      /* 控件事件（阻止冒泡） */
      playBtn.addEventListener('click', stopWrap(togglePlay));
      prevBtn.addEventListener('click', stopWrap(() => prevByMode()));
      nextBtn.addEventListener('click', stopWrap(() => nextByMode()));
      muteBtn.addEventListener('click', stopWrap(() => {
        audio.muted = !audio.muted;
        if (audio.muted || audio.volume === 0) { volIcon.innerHTML = '<path d="M3 9v6h4l5 5V4L7 9H3zM14 3l7 7-1.4 1.4L16 7.8V16h-2V8.6L9.4 4 11 2.4 14 3z"/>'; }
        else if (audio.volume < 0.5) { volIcon.innerHTML = '<path d="M3 9v6h4l5 5V4L7 9H3zM14 9v6c1.7-0.7 3-2.4 3-4.5S15.7 9.7 14 9z"/>'; }
        else { volIcon.innerHTML = '<path d="M3 9v6h4l5 5V4L7 9H3zM14 7v10c3-1 5-3.6 5-7s-2-6-5-7z"/>'; }
      }));

      /* 模式弹层 */
      modeBtn.addEventListener('click', stopWrap(() => {
        ratePop.style.display = 'none';
        modePop.style.display = modePop.style.display === 'flex' ? 'none' : 'flex';
      }));
      modePop.addEventListener('click', stopWrap((e) => {
        const item = e.target.closest('.mode-item');
        if (!item) return;
        playMode = item.getAttribute('data-mode');
        document.querySelectorAll('#mode-pop .mode-item').forEach(el => el.classList.toggle('active', el === item));
        modePop.style.display = 'none';
      }));

      /* 倍速弹层 */
      rateBtn.addEventListener('click', stopWrap(() => {
        modePop.style.display = 'none';
        ratePop.style.display = ratePop.style.display === 'flex' ? 'none' : 'flex';
      }));
      ratePop.addEventListener('click', stopWrap((e) => {
        const item = e.target.closest('.rate-item');
        if (!item) return;
        const r = parseFloat(item.getAttribute('data-rate'));
        audio.playbackRate = r;
        rateText.innerText = r.toFixed(1) + 'x';
        document.querySelectorAll('#rate-pop .rate-item').forEach(el => el.classList.toggle('active', el === item));
        ratePop.style.display = 'none';
      }));

      /* 点击其他区域关闭弹层 */
      document.addEventListener('click', (e) => {
        if (!modeBtn.contains(e.target) && !modePop.contains(e.target)) modePop.style.display = 'none';
        if (!rateBtn.contains(e.target) && !ratePop.contains(e.target)) ratePop.style.display = 'none';
      });

      /* 音频事件与切歌模式 */
      audio.addEventListener('timeupdate', () => {
        if (isDraggingProgress) return;
        const percent = (audio.currentTime / audio.duration) * 100;
        progressFill.style.width = `${percent}%`;
        knobEl.style.left = `${percent}%`;
        timeCurEl.innerText = formatTime(audio.currentTime);
      });
      audio.addEventListener('loadedmetadata', () => { timeTotalEl.innerText = formatTime(audio.duration); });
      audio.addEventListener('ended', () => {
        if (playMode === 'single') { audio.currentTime = 0; playTrack(); }
        else { nextByMode(); }
      });
      function prevByMode() {
        if (playMode === 'shuffle') currentIndex = Math.floor(Math.random() * playlist.length);
        else currentIndex = (currentIndex - 1 + playlist.length) % playlist.length;
        loadTrack(currentIndex); playTrack();
      }
      function nextByMode() {
        if (playMode === 'shuffle') currentIndex = Math.floor(Math.random() * playlist.length);
        else currentIndex = (currentIndex + 1) % playlist.length;
        loadTrack(currentIndex); playTrack();
      }

      /* 进度条拖拽（鼠标/触摸） */
      function handleProgressInput(clientX) {
        const rect = progressEl.getBoundingClientRect();
        let x = clientX - rect.left; x = Math.max(0, Math.min(x, rect.width));
        const pct = (x / rect.width) * 100; progressFill.style.width = `${pct}%`; knobEl.style.left = `${pct}%`;
        return (x / rect.width) * audio.duration;
      }
      progressEl.addEventListener('mousedown', stopWrap((e) => { isDraggingProgress = true; progressEl.classList.add('dragging'); const t = handleProgressInput(e.clientX); timeCurEl.innerText = formatTime(t); }));
      document.addEventListener('mousemove', (e) => { if (isDraggingProgress) { e.preventDefault(); const t = handleProgressInput(e.clientX); timeCurEl.innerText = formatTime(t); } });
      document.addEventListener('mouseup', (e) => { if (isDraggingProgress) { isDraggingProgress = false; progressEl.classList.remove('dragging'); const t = handleProgressInput(e.clientX); if (isFinite(t)) audio.currentTime = t; } });

      function getTouchX(e){ return (e.touches&&e.touches[0]) ? e.touches[0].clientX : (e.changedTouches&&e.changedTouches[0] ? e.changedTouches[0].clientX : 0); }
      progressEl.addEventListener('touchstart', (e) => { e.stopPropagation(); e.preventDefault(); isDraggingProgress = true; const t = handleProgressInput(getTouchX(e)); timeCurEl.innerText = formatTime(t); }, { passive:false });
      document.addEventListener('touchmove', (e) => { if (isDraggingProgress) { e.preventDefault(); const t = handleProgressInput(getTouchX(e)); timeCurEl.innerText = formatTime(t); } }, { passive:false });
      document.addEventListener('touchend', (e) => { if (isDraggingProgress) { isDraggingProgress = false; const t = handleProgressInput(getTouchX(e)); if (isFinite(t)) audio.currentTime = t; } }, { passive:false });

      /* 音量拖拽（鼠标/触摸） */
      function handleVolumeInput(clientX) {
        const rect = volEl.getBoundingClientRect();
        let x = clientX - rect.left; x = Math.max(0, Math.min(x, rect.width));
        const p = x / rect.width; volFill.style.width = `${p * 100}%`; audio.volume = p;
        if (p === 0 || audio.muted) { volIcon.innerHTML = '<path d="M3 9v6h4l5 5V4L7 9H3zM14 3l7 7-1.4 1.4L16 7.8V16h-2V8.6L9.4 4 11 2.4 14 3z"/>'; }
        else if (p < 0.5) { volIcon.innerHTML = '<path d="M3 9v6h4l5 5V4L7 9H3zM14 9v6c1.7-0.7 3-2.4 3-4.5S15.7 9.7 14 9z"/>'; }
        else { volIcon.innerHTML = '<path d="M3 9v6h4l5 5V4L7 9H3zM14 7v10c3-1 5-3.6 5-7s-2-6-5-7z"/>'; }
      }
      volEl.addEventListener('mousedown', stopWrap((e) => { isDraggingVolume = true; handleVolumeInput(e.clientX); }));
      document.addEventListener('mousemove', (e) => { if (isDraggingVolume) { e.preventDefault(); handleVolumeInput(e.clientX); } });
      document.addEventListener('mouseup', () => { isDraggingVolume = false; });
      volEl.addEventListener('touchstart', (e) => { e.stopPropagation(); e.preventDefault(); isDraggingVolume = true; handleVolumeInput(getTouchX(e)); }, { passive:false });
      document.addEventListener('touchmove', (e) => { if (isDraggingVolume) { e.preventDefault(); handleVolumeInput(getTouchX(e)); } }, { passive:false });
      document.addEventListener('touchend', () => { isDraggingVolume = false; }, { passive:false });

      /* 简易播放列表开关（示例） */
      listBtn.addEventListener('click', stopWrap(() => {
        playlistPanel.style.display = playlistPanel.style.display === 'block' ? 'none' : 'block';
      }));

      /* 提供给 HTML 的播放列表切换 */
      window.playIndex = function(index){ currentIndex = index; loadTrack(currentIndex); playTrack(); }

      /* 初始化第一首 */
      loadTrack(currentIndex);
    })();
    </script>
</body>
</html>