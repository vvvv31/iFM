<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>英语学习中心 - 星之声</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="../js/search.js"></script>
    <style>
        /* 首页特有样式 */
        .recommend-section {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        /* 轮播图样式 - 替换原来的大卡片 */
        .carousel-container {
            flex: 2;
            min-width: 300px;
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .carousel {
            position: relative;
            width: 100%;
            height: 100%;
            min-height: 200px;
            overflow: hidden;
            background-color: #E0FFFF;
            border: 2px solid #FF8C00;
            border-radius: 8px;
        }

        .carousel-inner {
            display: flex;
            transition: transform 0.5s ease-in-out;
            height: 100%;
        }

        .carousel-item {
            min-width: 100%;
            padding: 30px 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            background-color: #E0FFFF;
            box-sizing: border-box;
        }

        .carousel-item h2 {
            color: #FF8C00;
            font-size: 28px;
            margin-bottom: 10px;
        }

        .carousel-item p {
            color: #666;
            font-size: 16px;
            margin-bottom: 15px;
            max-width: 80%;
        }

        .carousel-btn {
            background-color: #FF8C00;
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s ease;
        }

        .carousel-btn:hover {
            background-color: #e67e00;
        }

        .carousel-controls {
            position: absolute;
            top: 50%;
            width: 100%;
            display: flex;
            justify-content: space-between;
            transform: translateY(-50%);
            padding: 0 10px;
            box-sizing: border-box;
            z-index: 10;
        }

        .carousel-btn-prev,
        .carousel-btn-next {
            background-color: rgba(255, 140, 0, 0.8);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.3s ease;
        }

        .carousel-btn-prev:hover,
        .carousel-btn-next:hover {
            background-color: rgba(255, 140, 0, 1);
            transform: scale(1.1);
        }

        .carousel-indicators {
            position: absolute;
            bottom: 15px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 8px;
            z-index: 10;
        }

        .carousel-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.5);
            border: 1px solid #FF8C00;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .carousel-indicator.active {
            background-color: #FF8C00;
            transform: scale(1.2);
        }

        .small-recommend-grid {
            flex: 3;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            min-width: 300px;
        }

        .small-recommend {
            background-color: #FFF8DC;
            border: 1px solid #FFDAB9;
            border-radius: 8px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            transition: all 0.3s ease;
        }

        .small-recommend:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(255, 140, 0, 0.1);
        }

        .small-recommend h3 {
            color: #FF8C00;
            font-size: 18px;
            margin-bottom: 5px;
        }

        .small-recommend p {
            color: #333;
            font-size: 14px;
            font-weight: bold;
        }

        .daily-quote-section {
            margin-bottom: 20px;
        }

        .daily-quote {
            background-color: #FFF8DC;
            border: 1px solid #FFDAB9;
            border-radius: 8px;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .quote-content {
            flex: 1;
        }

        .quote-content span {
            display: inline-block;
            background-color: #FF8C00;
            color: white;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 12px;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .quote-text {
            font-size: 16px;
            color: #333;
            line-height: 1.6;
            font-style: italic;
        }

        .copy-btn {
            background-color: #FF8C00;
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s ease;
            margin-left: 20px;
            white-space: nowrap;
        }

        .copy-btn:hover {
            background-color: #e67e00;
        }

        .rank-section {
            margin-bottom: 20px;
        }

        .rank-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .rank-item {
            background-color: #fff;
            border: 1px solid #FFDAB9;
            border-radius: 8px;
            overflow: hidden;
        }

        .rank-header {
            background-color: #FFF8DC;
            padding: 12px 15px;
            border-bottom: 1px solid #FFDAB9;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .rank-header h3 {
            color: #333;
            font-size: 14px;
            font-weight: bold;
            margin: 0;
        }

        .rank-icon {
            font-size: 18px;
        }

        .rank-content {
            padding: 15px;
        }

        .rank-item-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .rank-song {
            display: flex;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px dashed #FFDAB9;
        }

        .rank-song:last-child {
            border-bottom: none;
        }

        .rank-num {
            width: 25px;
            height: 25px;
            background-color: #FF8C00;
            color: white;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            margin-right: 10px;
            flex-shrink: 0;
        }

        .rank-title {
            font-size: 14px;
            color: #333;
            flex: 1;
        }

        .channels-section {
            margin-bottom: 20px;
        }

        .channels-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .channels-header h2 {
            color: #333;
            font-size: 16px;
            font-weight: bold;
            margin: 0;
        }

        .view-more {
            color: #FF8C00;
            font-size: 14px;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .view-more:hover {
            color: #e67e00;
        }

        .channels-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
        }

        .channel-item {
            background-color: #fff;
            border: 1px solid #FFDAB9;
            border-radius: 8px;
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .channel-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(255, 140, 0, 0.1);
        }

        .channel-icon {
            font-size: 24px;
            width: 50px;
            height: 50px;
            background-color: #E0FFFF;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .channel-info {
            flex: 1;
        }

        .channel-title {
            color: #333;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 4px;
        }

        .channel-desc {
            color: #666;
            font-size: 12px;
            line-height: 1.4;
        }

        /* 响应式调整 */
        @media (max-width: 768px) {
            .recommend-section {
                flex-direction: column;
            }

            .carousel-container,
            .small-recommend-grid {
                width: 100%;
            }

            .rank-container {
                grid-template-columns: 1fr;
            }

            .channels-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .carousel-controls {
                padding: 0 5px;
            }

            .carousel-btn-prev,
            .carousel-btn-next {
                width: 35px;
                height: 35px;
                font-size: 16px;
            }
        }

        @media (max-width: 480px) {
            .small-recommend-grid {
                grid-template-columns: 1fr;
            }

            .channels-grid {
                grid-template-columns: 1fr;
            }

            .daily-quote {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }

            .copy-btn {
                margin-left: 0;
            }

            .carousel-indicators {
                bottom: 10px;
            }
        }

        /* PlayBar styles (from PlayBar.html) */
        body { margin: 0; padding-bottom: 96px; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
        .pv-player-bar {
          position: fixed; left: 0; right: 0; bottom: 0;
          width: 100%; height: 96px; background: #ffffff;
          border-top: 1px solid #e0e0e0; box-shadow: 0 -4px 20px rgba(0,0,0,0.08);
          z-index: 29999; display: flex; align-items: center; user-select: none; pointer-events: auto;
        }
        .pv-inner {
          width: 100%; max-width: 1200px; margin: 0 auto;
          display: grid; grid-template-columns: auto 1fr auto; align-items: center;
          column-gap: 16px; padding: 0 24px; height: 100%;
        }
        .pv-left { display: inline-flex; align-items: center; gap: 12px; min-width: 240px; }
        .pv-cover {
          width: 52px; height: 52px; border-radius: 8px;
          background: #eee no-repeat center/cover;
          box-shadow: 0 2px 6px rgba(0,0,0,0.1);
          flex-shrink: 0;
        }
        .pv-meta { display: flex; flex-direction: column; min-width: 0; }
        .pv-title {
          font-size: 16px; font-weight: 700; color: #222;
          white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
        }
        .pv-artist {
          font-size: 12px; color: #666; margin-top: 2px;
          white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
        }
        .pv-center {
          display: flex; flex-direction: column; align-items: center; justify-content: center;
          gap: 8px; min-width: 0;
        }
        .pv-controls { display: inline-flex; align-items: center; gap: 18px; }
        .ctrl-btn, .mode-btn, .rate-btn {
          background: transparent; border: none; cursor: pointer; color: #444;
          font-size: 18px; padding: 6px; display: inline-flex; align-items: center; justify-content: center; transition: color 0.2s;
        }
        .ctrl-btn:hover, .mode-btn:hover, .rate-btn:hover { color: #ff8c00; }
        .play-btn {
          width: 44px; height: 44px; border-radius: 50%; background: #ff8c00; color: #fff; border: none;
          display: inline-flex; align-items: center; justify-content: center; cursor: pointer;
          box-shadow: 0 4px 10px rgba(255,140,0,0.30); transition: transform 0.1s, background 0.2s;
        }
        .play-btn:hover { background: #e67e00; transform: scale(1.05); }
        .icon { width: 18px; height: 18px; fill: currentColor; }
        .pv-progress-row { display: flex; align-items: center; gap: 12px; width: 100%; }
        .time.small { font-size: 12px; color: #888; width: 48px; text-align: center; font-variant-numeric: tabular-nums; }
        .pv-progress { position: relative; flex: 1; height: 6px; background: #eee; border-radius: 3px; cursor: pointer; touch-action: none; }
        .pv-progress::before { content: ''; position: absolute; top: -10px; bottom: -10px; left: 0; right: 0; z-index: 1; }
        .pv-progress-fill { position: absolute; left: 0; top: 0; bottom: 0; background: #ff8c00; border-radius: 3px; width: 0%; pointer-events: none; }
        .pv-knob {
          position: absolute; top: 50%; right: -6px; transform: translateY(-50%); width: 12px; height: 12px;
          background: #fff; border: 2px solid #ff8c00; border-radius: 50%; box-shadow: 0 1px 4px rgba(0,0,0,0.2);
          opacity: 0; transition: opacity 0.2s; pointer-events: none;
        }
        .pv-progress:hover .pv-knob, .pv-progress.dragging .pv-knob { opacity: 1; }
        .pv-right {
          display: inline-flex; align-items: center; justify-content: flex-end;
          gap: 12px; min-width: 240px;
        }
        .pv-volume { width: 140px; height: 20px; display: flex; align-items: center; cursor: pointer; position: relative; }
        .pv-volume-bar { width: 100%; height: 4px; background: #eee; border-radius: 2px; position: relative; overflow: visible; pointer-events: none; }
        .pv-volume-fill { height: 100%; background: #888; width: 50%; border-radius: 2px; position: relative; }
        .pv-volume-fill::after {
          content: ''; position: absolute; right: -5px; top: 50%; transform: translateY(-50%); width: 10px; height: 10px;
          background: #fff; border: 1px solid #888; border-radius: 50%; opacity: 0; transition: opacity 0.2s;
        }
        .pv-volume:hover .pv-volume-fill::after { opacity: 1; }
        .popover {
          position: absolute; bottom: 100%;
          left: 50%; transform: translateX(-50%);
          background: #fff; border: 1px solid #ddd; border-radius: 8px;
          box-shadow: 0 10px 24px rgba(0,0,0,0.12);
          padding: 8px; z-index: 30000; display: none;
        }
        .popover.show { display: flex; }
        .mode-popover { gap: 10px; align-items: center; }
        .mode-item {
          width: 40px; height: 40px; border-radius: 8px; border: 1px solid #eee;
          display: inline-flex; align-items: center; justify-content: center; cursor: pointer; color: #444;
        }
        .mode-item:hover { color: #ff8c00; border-color: #ffeed6; background: #fff9f0; }
        .mode-item.active { color: #fff; background: #ff8c00; border-color: #ff8c00; }
        .rate-popover { flex-direction: column; min-width: 140px; }
        .rate-item { padding: 8px 12px; font-size: 14px; color: #333; cursor: pointer; border-radius: 6px; }
        .rate-item:hover { background: #f7f7f7; }
        .rate-item.active { color: #ff8c00; font-weight: 700; background: #fff4e6; }
        @media (max-width: 900px) {
          .pv-left { min-width: 0; }
          .pv-right { min-width: 0; }
          .pv-inner { grid-template-columns: auto 1fr auto; column-gap: 10px; padding: 0 12px; }
        }
    </style>
</head>
<body>
    <!-- 音频元素 (保留原来元素 in case other scripts use it) -->
    <audio id="audioPlayer" controls style="display: none;">
        <source src="" type="audio/mpeg">
        您的浏览器不支持音频播放
    </audio>

    <!-- 顶部导航栏 -->
    <header class="header">
        <div class="logo">
            <div class="logo-img"></div>
            <span class="logo-text">星之声</span>
        </div>
        <nav class="main-nav">
            <a href="index.html" class="nav-item active">首页</a>
            <a href="category.html" class="nav-item">分类</a>
            <a href="channel.html" class="nav-item">社区</a>
        </nav>
        <div class="search-box">
            <input type="text" placeholder="搜索课程、频道..." class="search-input" id="homeSearchInput">
            <button class="search-btn" id="homeSearchBtn"><i class="fas fa-search"></i></button>
        </div>
        <div class="user-functions">
            <a href="my-recent.html" class="func-item">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                </svg>
            </a>
            <a href="my-message.html" class="func-item"><i class="fas fa-bell"></i> 消息</a>
            <a href="my-collect.html" class="func-item"><i class="fas fa-star"></i> 收藏</a>
            <a href="my-recent.html" class="func-item"><i class="fas fa-history"></i> 历史</a>
            <a href="my-creator_center.html" class="func-item"><i class="fas fa-pen"></i> 创作中心</a>
            <a href="login.html"><button class="submit-btn">登录/注册</button></a>
        </div>
    </header>

    <!-- 主要内容区 -->
    <main class="main-content">
        <!-- 用户信息区（与my-collect.html统一） -->
        <section class="user-info">
            <div class="avatar-wrapper">
                <div class="avatar"></div>
            </div>
            <div class="user-detail">
                <div class="username">欢迎学习英语</div>
                <div class="identity">英语学习者</div>
                <div class="stats">
                    <span>关注 <b>0</b></span>
                    <span>粉丝 <b>0</b></span>
                    <span>学习时长 <b>0</b> 小时</span>
                </div>
            </div>
        </section>

        <!-- 精选课程区域 - 改为轮播图形式 -->
        <section class="recommend-section">
            <div class="carousel-container">
                <div class="carousel" id="courseCarousel">
                    <div class="carousel-inner" id="carouselInner">
                        <!-- 轮播项 1 -->
                        <div class="carousel-item active">
                            <h2>零基础英语入门</h2>
                            <p>从字母发音到基础对话，系统学习英语基础知识</p>
                            <button class="carousel-btn" onclick="window.location.href='program_list.html?course=zero_basics'">开始学习</button>
                        </div>
                        <!-- 轮播项 2 -->
                        <div class="carousel-item">
                            <h2>商务英语进阶</h2>
                            <p>掌握职场沟通技巧，提升商务英语应用能力</p>
                            <button class="carousel-btn" onclick="window.location.href='program_list.html?course=business_advanced'">开始学习</button>
                        </div>
                        <!-- 轮播项 3 -->
                        <div class="carousel-item">
                            <h2>日常口语300句</h2>
                            <p>学习最实用的日常英语表达，提升口语流利度</p>
                            <button class="carousel-btn" onclick="window.location.href='program_list.html?course=daily_conversation'">开始学习</button>
                        </div>
                        <!-- 轮播项 4 -->
                        <div class="carousel-item">
                            <h2>英语听力技巧课</h2>
                            <p>系统训练听力理解能力，掌握听力技巧与方法</p>
                            <button class="carousel-btn" onclick="window.location.href='program_list.html?course=listening_skills'">开始学习</button>
                        </div>
                        <!-- 轮播项 5 -->
                        <div class="carousel-item">
                            <h2>英文写作提升</h2>
                            <p>学习英文写作技巧，提升书面表达能力</p>
                            <button class="carousel-btn" onclick="window.location.href='program_list.html?course=writing_improvement'">开始学习</button>
                        </div>
                    </div>

                    <!-- 轮播控制按钮 -->
                    <div class="carousel-controls">
                        <button class="carousel-btn-prev" id="carouselPrev">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <button class="carousel-btn-next" id="carouselNext">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>

                    <!-- 轮播指示器 -->
                    <div class="carousel-indicators" id="carouselIndicators">
                        <!-- 指示器将由JS动态生成 -->
                    </div>
                </div>
            </div>

            <div class="small-recommend-grid">
                <div class="small-recommend" onclick="window.location.href='program_list.html?course=business_english'">
                    <div class="recommend-info">
                        <h3>精选</h3>
                        <p>商务英语</p>
                    </div>
                </div>
                <div class="small-recommend" onclick="window.location.href='program_list.html?course=daily_dialogue'">
                    <div class="recommend-info">
                        <h3>精选</h3>
                        <p>日常对话</p>
                    </div>
                </div>
                <div class="small-recommend" onclick="window.location.href='program_list.html?course=listening_training'">
                    <div class="recommend-info">
                        <h3>精选</h3>
                        <p>听力训练</p>
                    </div>
                </div>
                <div class="small-recommend" onclick="window.location.href='program_list.html?course=reading_comprehension'">
                    <div class="recommend-info">
                        <h3>精选</h3>
                        <p>阅读理解</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 每日一句 -->
        <section class="daily-quote-section">
            <div class="daily-quote">
                <div class="quote-content">
                    <span>每日一句</span>
                    <p class="quote-text">The way to learn a language is to practice speaking it as often as possible. - Paul Pimsleur</p>
                    <p style="margin-top: 8px; font-size: 14px; color: #666;">学习一门语言的方法是尽可能多地练习说它。 - 保罗·皮姆斯勒</p>
                </div>
                <button class="copy-btn" id="readAloudBtn">
                    <i class="fas fa-volume-up"></i> 朗读
                </button>
            </div>
        </section>

        <!-- 学习排行榜区域 -->
        <section class="rank-section">
            <div class="rank-container">
                <div class="rank-item">
                    <div class="rank-header">
                        <h3>热门课程</h3>
                        <span class="rank-icon">🔥</span>
                    </div>
                    <div class="rank-content">
                        <div class="rank-item-list">
                            <div class="rank-song" onclick="window.location.href='program_list.html?course=zero_basics'">
                                <span class="rank-num">1</span>
                                <span class="rank-title">零基础英语入门</span>
                            </div>
                            <div class="rank-song" onclick="window.location.href='program_list.html?course=business_advanced'">
                                <span class="rank-num">2</span>
                                <span class="rank-title">商务英语进阶</span>
                            </div>
                            <div class="rank-song" onclick="window.location.href='program_list.html?course=daily_conversation'">
                                <span class="rank-num">3</span>
                                <span class="rank-title">日常口语300句</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="rank-item">
                    <div class="rank-header">
                        <h3>学习达人</h3>
                        <span class="rank-icon">⭐</span>
                    </div>
                    <div class="rank-content">
                        <div class="rank-item-list">
                            <div class="rank-song" onclick="window.location.href='my-recent.html'">
                                <span class="rank-num">1</span>
                                <span class="rank-title">学习者 A</span>
                            </div>
                            <div class="rank-song" onclick="window.location.href='my-recent.html'">
                                <span class="rank-num">2</span>
                                <span class="rank-title">学习者 B</span>
                            </div>
                            <div class="rank-song" onclick="window.location.href='my-recent.html'">
                                <span class="rank-num">3</span>
                                <span class="rank-title">学习者 C</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="rank-item">
                    <div class="rank-header">
                        <h3>最新上线</h3>
                        <span class="rank-icon">✨</span>
                    </div>
                    <div class="rank-content">
                        <div class="rank-item-list">
                            <div class="rank-song" onclick="window.location.href='program_list.html?course=listening_skills'">
                                <span class="rank-num">1</span>
                                <span class="rank-title">英语听力技巧课</span>
                            </div>
                            <div class="rank-song" onclick="window.location.href='program_list.html?course=writing_improvement'">
                                <span class="rank-num">2</span>
                                <span class="rank-title">英文写作提升</span>
                            </div>
                            <div class="rank-song" onclick="window.location.href='program_list.html?course=pronunciation_correction'">
                                <span class="rank-num">3</span>
                                <span class="rank-title">英语发音纠正</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 学习资源分类区域 -->
        <section class="channels-section">
            <div class="channels-header">
                <h2>学习资源分类</h2>
                <a href="category.html" class="view-more">查看更多 →</a>
            </div>
            <div class="channels-grid">
                <div class="channel-item" onclick="window.location.href='program_list.html?course=daily_conversation'">
                    <div class="channel-icon">🗣️</div>
                    <div class="channel-info">
                        <h3 class="channel-title">口语练习</h3>
                        <p class="channel-desc">提升口语表达能力</p>
                    </div>
                </div>
                <div class="channel-item" onclick="window.location.href='program_list.html?course=listening_skills'">
                    <div class="channel-icon">👂</div>
                    <div class="channel-info">
                        <h3 class="channel-title">听力训练</h3>
                        <p class="channel-desc">提高听力理解水平</p>
                    </div>
                </div>
                <div class="channel-item" onclick="window.location.href='program_list.html?course=reading_comprehension'">
                    <div class="channel-icon">📖</div>
                    <div class="channel-info">
                        <h3 class="channel-title">阅读理解</h3>
                        <p class="channel-desc">增强阅读能力</p>
                    </div>
                </div>
                <div class="channel-item" onclick="window.location.href='program_list.html?course=writing_improvement'">
                    <div class="channel-icon">✍️</div>
                    <div class="channel-info">
                        <h3 class="channel-title">写作提升</h3>
                        <p class="channel-desc">提升英文写作水平</p>
                    </div>
                </div>
                <div class="channel-item" onclick="window.location.href='program_list.html?course=business_english'">
                    <div class="channel-icon">🏢</div>
                    <div class="channel-info">
                        <h3 class="channel-title">商务英语</h3>
                        <p class="channel-desc">职场英语技巧</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- 底部播放栏（替换为 PlayBar.html 版本） -->
    <aside id="pv-player" class="pv-player-bar" role="region" aria-label="播放器">
      <div class="pv-inner">
        <!-- 左侧：封面与标题（可点击跳转） -->
        <div class="pv-left">
          <div id="pv-cover" class="pv-cover" role="button" tabindex="0" aria-label="打开播放页面"></div>
          <div class="pv-meta">
            <div id="pv-title" class="pv-title" role="button" tabindex="0">Kalimba (Test Audio)</div>
            <div id="pv-artist" class="pv-artist">Ninja Tuna</div>
          </div>
        </div>

        <!-- 中间：控制与进度 -->
        <div class="pv-center">
          <div class="pv-controls">
            <button id="pv-prev" class="ctrl-btn" title="上一首" aria-label="上一首">
              <svg class="icon" viewBox="0 0 24 24"><path d="M6 6h2v12H6V6zm3.5 6l8.5 6V6l-8.5 6z"/></svg>
            </button>
            <button id="pv-play" class="play-btn" title="播放/暂停" aria-label="播放/暂停">
              <svg id="play-icon" class="icon" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </button>
            <button id="pv-next" class="ctrl-btn" title="下一首" aria-label="下一首">
              <svg class="icon" viewBox="0 0 24 24"><path d="M16 6h2v12h-2V6zM6 18l8.5-6L6 6v12z"/></svg>
            </button>

            <!-- 播放模式弹层 -->
            <div style="position: relative;">
              <button id="pv-mode-btn" class="mode-btn" title="播放模式" aria-label="播放模式">
                <svg class="icon" viewBox="0 0 24 24"><path d="M7 7h8v3l4-4-4-4v3H5v6h2V7zm10 10H9v-3l-4 4 4 4v-3h10v-6h-2v4z"/></svg>
              </button>
              <div id="mode-pop" class="popover mode-popover">
                <div class="mode-item active" data-mode="single" title="单曲循环">
                  <svg class="icon" viewBox="0 0 24 24"><path d="M12 5v4l-1.5-1.5C8 10 8 14 10.5 16.5S16 19 18.5 16.5L20 18c-3 3-8 3-11 0S6 9 9 6L12 5z"/></svg>
                </div>
                <div class="mode-item" data-mode="list" title="歌单顺序循环">
                  <svg class="icon" viewBox="0 0 24 24"><path d="M4 6h12v2H4V6zm0 5h12v2H4v-2zm0 5h8v2H4v-2zm15-7l-3 3h2v4h2v-4h2l-3-3z"/></svg>
                </div>
                <div class="mode-item" data-mode="shuffle" title="歌单乱序循环">
                  <svg class="icon" viewBox="0 0 24 24"><path d="M16 3h5v5h-2V6.41l-4.29 4.3-1.42-1.42L17.59 5H16V3zM4 6h7l2 2H4V6zm0 6h5l2 2H4v-2zm12 3h1.59l-2.29 2.29 1.42 1.42L20 17.41V19h2v-5h-5v2z"/></svg>
                </div>
              </div>
            </div>

            <!-- 倍速弹层 -->
            <div class="rate-control" style="position: relative;">
              <button id="pv-rate-btn" class="rate-btn" title="倍速"><span id="rate-text" style="font-size: 12px; font-weight: bold;">1x</span></button>
              <div id="rate-pop" class="popover rate-popover">
                <div class="rate-item" data-rate="0.5">0.5x</div>
                <div class="rate-item active" data-rate="1">1.0x</div>
                <div class="rate-item" data-rate="1.5">1.5x</div>
                <div class="rate-item" data-rate="2">2.0x</div>
              </div>
            </div>
          </div>

          <div class="pv-progress-row">
            <span id="pv-time-cur" class="time small">00:00</span>
            <div id="pv-progress" class="pv-progress">
              <div id="pv-progress-fill" class="pv-progress-fill"></div>
              <div id="pv-knob" class="pv-knob"></div>
            </div>
            <span id="pv-time-total" class="time small">00:00</span>
          </div>
        </div>

        <!-- 右侧：音量 + 歌单按钮 -->
        <div class="pv-right">
          <button id="pv-mute" class="ctrl-btn" title="静音/取消静音" aria-label="静音">
            <svg id="vol-icon" class="icon" viewBox="0 0 24 24"><path d="M3 9v6h4l5 5V4L7 9H3z"/></svg>
          </button>
          <div id="pv-volume" class="pv-volume">
            <div class="pv-volume-bar"><div id="pv-volume-fill" class="pv-volume-fill"></div></div>
          </div>
          <button id="pv-list-btn" class="ctrl-btn" title="播放列表" aria-label="播放列表">
            <svg class="icon" viewBox="0 0 24 24"><path d="M3 5h18v2H3V5zm0 6h12v2H3v-2zm0 6h8v2H3v-2z"/></svg>
          </button>
        </div>
      </div>

      <!-- 播放列表弹窗（示例） -->
      <div id="playlist-panel" class="playlist-panel" style="display:none;">
        <div class="playlist-item active" onclick="playIndex(0)">1. Kalimba (Test)</div>
        <div class="playlist-item" onclick="playIndex(1)">2. Sample MP3 (Test)</div>
      </div>

      <audio id="pv-audio" preload="metadata"></audio>
    </aside>

<script>
/* 轮播图功能 */
document.addEventListener('DOMContentLoaded', function() {
    const carouselInner = document.getElementById('carouselInner');
    const carouselPrev = document.getElementById('carouselPrev');
    const carouselNext = document.getElementById('carouselNext');
    const carouselIndicators = document.getElementById('carouselIndicators');
    if (!carouselInner) return;

    const carouselItems = carouselInner.querySelectorAll('.carousel-item');
    const totalItems = carouselItems.length;
    let currentIndex = 0;
    let autoPlayInterval;

    function generateIndicators() {
        carouselIndicators.innerHTML = '';
        for (let i = 0; i < totalItems; i++) {
            const indicator = document.createElement('div');
            indicator.className = 'carousel-indicator';
            if (i === currentIndex) indicator.classList.add('active');
            indicator.addEventListener('click', () => goToSlide(i));
            carouselIndicators.appendChild(indicator);
        }
    }

    function updateCarousel() {
        carouselItems.forEach(item => item.classList.remove('active'));
        carouselItems[currentIndex].classList.add('active');
        carouselInner.style.transform = `translateX(-${currentIndex * 100}%)`;

        const indicators = carouselIndicators.querySelectorAll('.carousel-indicator');
        indicators.forEach((indicator, index) => {
            indicator.classList.toggle('active', index === currentIndex);
        });
    }

    function goToSlide(index) {
        currentIndex = (index + totalItems) % totalItems;
        updateCarousel();
        resetAutoPlay();
    }

    function nextSlide() { goToSlide(currentIndex + 1); }
    function prevSlide() { goToSlide(currentIndex - 1); }

    function startAutoPlay() { autoPlayInterval = setInterval(nextSlide, 5000); }
    function resetAutoPlay() { clearInterval(autoPlayInterval); startAutoPlay(); }

    generateIndicators();
    updateCarousel();
    startAutoPlay();

    if (carouselPrev) carouselPrev.addEventListener('click', (e) => { e.stopPropagation(); prevSlide(); });
    if (carouselNext) carouselNext.addEventListener('click', (e) => { e.stopPropagation(); nextSlide(); });

    const carousel = document.getElementById('courseCarousel');
    if (carousel) {
        carousel.addEventListener('mouseenter', () => clearInterval(autoPlayInterval));
        carousel.addEventListener('mouseleave', () => startAutoPlay());
    }
});

/* 每日一句朗读按钮：跳转到 Audio-Related.html */
(function() {
  const readAloudBtn = document.getElementById('readAloudBtn');
  if (readAloudBtn) {
    readAloudBtn.addEventListener('click', function() {
      const quoteTextEl = document.querySelector('.quote-text');
      const text = quoteTextEl ? quoteTextEl.textContent : '';
      const url = `Audio-Related.html?auto=read&text=${encodeURIComponent(text)}`;
      window.location.href = url;
    });
  }
})();

/* PlayBar 业务脚本（来自 PlayBar.html） */
;(function () {
  /* 两个样例音频 */
  const playlist = [
    { title: "Kalimba (Test Audio)", artist: "Ninja Tuna", cover: "", src: "https://www.learningcontainer.com/wp-content/uploads/2020/02/Kalimba.mp3" },
    { title: "Sample MP3 (700KB)", artist: "Sample Source", cover: "", src: "https://sample.cat/downloads/file_example_MP3_700KB.mp3" }
  ];

  let currentIndex = 0;
  let isPlaying = false;
  let isDraggingProgress = false;
  let isDraggingVolume = false;
  let playMode = 'list'; /* single | list | shuffle */

  const audio = document.getElementById('pv-audio');
  const playBtn = document.getElementById('pv-play');
  const playIcon = document.getElementById('play-icon');
  const prevBtn = document.getElementById('pv-prev');
  const nextBtn = document.getElementById('pv-next');
  const titleEl = document.getElementById('pv-title');
  const artistEl = document.getElementById('pv-artist');
  const coverEl = document.getElementById('pv-cover');
  const progressEl = document.getElementById('pv-progress');
  const progressFill = document.getElementById('pv-progress-fill');
  const knobEl = document.getElementById('pv-knob');
  const timeCurEl = document.getElementById('pv-time-cur');
  const timeTotalEl = document.getElementById('pv-time-total');
  const volEl = document.getElementById('pv-volume');
  const volFill = document.getElementById('pv-volume-fill');
  const listBtn = document.getElementById('pv-list-btn');
  const playlistPanel = document.getElementById('playlist-panel');
  const rateBtn = document.getElementById('pv-rate-btn');
  const rateText = document.getElementById('rate-text');
  const muteBtn = document.getElementById('pv-mute');
  const volIcon = document.getElementById('vol-icon');
  const modeBtn = document.getElementById('pv-mode-btn');
  const modePop = document.getElementById('mode-pop');
  const ratePop = document.getElementById('rate-pop');

  function loadTrack(index) {
    const track = playlist[index];
    titleEl.innerText = track.title;
    artistEl.innerText = track.artist;
    coverEl.style.backgroundImage = track.cover ? `url('${track.cover}')` : '';
    audio.src = track.src;
    document.querySelectorAll('.playlist-item').forEach((item, i) => item.classList.toggle('active', i === index));
  }
  function playTrack() { audio.play().then(() => { isPlaying = true; updatePlayIcon(); }).catch(err => console.error("Play failed:", err)); }
  function pauseTrack() { audio.pause(); isPlaying = false; updatePlayIcon(); }
  function togglePlay() { isPlaying ? pauseTrack() : playTrack(); }
  function updatePlayIcon() {
    playIcon.setAttribute('viewBox','0 0 24 24');
    playIcon.innerHTML = isPlaying ? '<path d="M6 5h4v14H6V5zm8 0h4v14h-4V5z"/>' : '<path d="M8 5v14l11-7z"/>';
  }
  function formatTime(s) { if (!s || isNaN(s)) return "00:00"; const m = Math.floor(s/60), ss = Math.floor(s%60); return `${m<10?'0':''}${m}:${ss<10?'0':''}${ss}`; }
  function stopWrap(handler) { return function(e){ e.stopPropagation(); handler(e); }; }

  /* 控件事件（阻止冒泡） */
  playBtn.addEventListener('click', stopWrap(togglePlay));
  prevBtn.addEventListener('click', stopWrap(() => prevByMode()));
  nextBtn.addEventListener('click', stopWrap(() => nextByMode()));
  muteBtn.addEventListener('click', stopWrap(() => {
    audio.muted = !audio.muted;
    if (audio.muted || audio.volume === 0) { volIcon.innerHTML = '<path d="M3 9v6h4l5 5V4L7 9H3zM14 3l7 7-1.4 1.4L16 7.8V16h-2V8.6L9.4 4 11 2.4 14 3z"/>'; }
    else if (audio.volume < 0.5) { volIcon.innerHTML = '<path d="M3 9v6h4l5 5V4L7 9H3zM14 9v6c1.7-0.7 3-2.4 3-4.5S15.7 9.7 14 9z"/>'; }
    else { volIcon.innerHTML = '<path d="M3 9v6h4l5 5V4L7 9H3zM14 7v10c3-1 5-3.6 5-7s-2-6-5-7z"/>'; }
  }));

  /* 模式弹层 */
  modeBtn.addEventListener('click', stopWrap(() => {
    ratePop.classList.remove('show');
    modePop.classList.toggle('show');
  }));
  modePop.addEventListener('click', stopWrap((e) => {
    const item = e.target.closest('.mode-item');
    if (!item) return;
    playMode = item.getAttribute('data-mode');
    document.querySelectorAll('#mode-pop .mode-item').forEach(el => el.classList.toggle('active', el === item));
    modePop.classList.remove('show');
  }));

  /* 倍速弹层 */
  rateBtn.addEventListener('click', stopWrap(() => {
    modePop.classList.remove('show');
    ratePop.classList.toggle('show');
  }));
  ratePop.addEventListener('click', stopWrap((e) => {
    const item = e.target.closest('.rate-item');
    if (!item) return;
    const r = parseFloat(item.getAttribute('data-rate'));
    audio.playbackRate = r;
    rateText.innerText = r.toFixed(1) + 'x';
    document.querySelectorAll('#rate-pop .rate-item').forEach(el => el.classList.toggle('active', el === item));
    ratePop.classList.remove('show');
  }));

  /* 点击其他区域关闭弹层 */
  document.addEventListener('click', (e) => {
    if (!modeBtn.contains(e.target) && !modePop.contains(e.target)) modePop.classList.remove('show');
    if (!rateBtn.contains(e.target) && !ratePop.contains(e.target)) ratePop.classList.remove('show');
  });

  /* 音频事件与切歌模式 */
  audio.addEventListener('timeupdate', () => {
    if (isDraggingProgress) return;
    const percent = (audio.currentTime / audio.duration) * 100;
    progressFill.style.width = `${percent}%`;
    knobEl.style.left = `${percent}%`;
    timeCurEl.innerText = formatTime(audio.currentTime);
  });
  audio.addEventListener('loadedmetadata', () => { timeTotalEl.innerText = formatTime(audio.duration); });
  audio.addEventListener('ended', () => {
    if (playMode === 'single') { audio.currentTime = 0; playTrack(); }
    else { nextByMode(); }
  });
  function prevByMode() {
    if (playMode === 'shuffle') currentIndex = Math.floor(Math.random() * playlist.length);
    else currentIndex = (currentIndex - 1 + playlist.length) % playlist.length;
    loadTrack(currentIndex); playTrack();
  }
  function nextByMode() {
    if (playMode === 'shuffle') currentIndex = Math.floor(Math.random() * playlist.length);
    else currentIndex = (currentIndex + 1) % playlist.length;
    loadTrack(currentIndex); playTrack();
  }

  /* 进度条拖拽（鼠标/触摸） */
  function handleProgressInput(clientX) {
    const rect = progressEl.getBoundingClientRect();
    let x = clientX - rect.left; x = Math.max(0, Math.min(x, rect.width));
    const pct = (x / rect.width) * 100; progressFill.style.width = `${pct}%`; knobEl.style.left = `${pct}%`;
    return (x / rect.width) * audio.duration;
  }
  progressEl.addEventListener('mousedown', stopWrap((e) => { isDraggingProgress = true; progressEl.classList.add('dragging'); const t = handleProgressInput(e.clientX); timeCurEl.innerText = formatTime(t); }));
  document.addEventListener('mousemove', (e) => { if (isDraggingProgress) { e.preventDefault(); const t = handleProgressInput(e.clientX); timeCurEl.innerText = formatTime(t); } });
  document.addEventListener('mouseup', (e) => { if (isDraggingProgress) { isDraggingProgress = false; progressEl.classList.remove('dragging'); const t = handleProgressInput(e.clientX); if (isFinite(t)) audio.currentTime = t; } });

  function getTouchX(e){ return (e.touches&&e.touches[0]) ? e.touches[0].clientX : (e.changedTouches&&e.changedTouches[0] ? e.changedTouches[0].clientX : 0); }
  progressEl.addEventListener('touchstart', (e) => { e.stopPropagation(); e.preventDefault(); isDraggingProgress = true; const t = handleProgressInput(getTouchX(e)); timeCurEl.innerText = formatTime(t); }, { passive:false });
  document.addEventListener('touchmove', (e) => { if (isDraggingProgress) { e.preventDefault(); const t = handleProgressInput(getTouchX(e)); timeCurEl.innerText = formatTime(t); } }, { passive:false });
  document.addEventListener('touchend', (e) => { if (isDraggingProgress) { isDraggingProgress = false; const t = handleProgressInput(getTouchX(e)); if (isFinite(t)) audio.currentTime = t; } }, { passive:false });

  /* 音量拖拽（鼠标/触摸） */
  function handleVolumeInput(clientX) {
    const rect = volEl.getBoundingClientRect();
    let x = clientX - rect.left; x = Math.max(0, Math.min(x, rect.width));
    const p = x / rect.width; volFill.style.width = `${p * 100}%`; audio.volume = p;
    if (p === 0 || audio.muted) { volIcon.innerHTML = '<path d="M3 9v6h4l5 5V4L7 9H3zM14 3l7 7-1.4 1.4L16 7.8V16h-2V8.6L9.4 4 11 2.4 14 3z"/>'; }
    else if (p < 0.5) { volIcon.innerHTML = '<path d="M3 9v6h4l5 5V4L7 9H3zM14 9v6c1.7-0.7 3-2.4 3-4.5S15.7 9.7 14 9z"/>'; }
    else { volIcon.innerHTML = '<path d="M3 9v6h4l5 5V4L7 9H3zM14 7v10c3-1 5-3.6 5-7s-2-6-5-7z"/>'; }
  }
  volEl.addEventListener('mousedown', stopWrap((e) => { isDraggingVolume = true; handleVolumeInput(e.clientX); }));
  document.addEventListener('mousemove', (e) => { if (isDraggingVolume) { e.preventDefault(); handleVolumeInput(e.clientX); } });
  document.addEventListener('mouseup', () => { isDraggingVolume = false; });
  volEl.addEventListener('touchstart', (e) => { e.stopPropagation(); e.preventDefault(); isDraggingVolume = true; handleVolumeInput(getTouchX(e)); }, { passive:false });
  document.addEventListener('touchmove', (e) => { if (isDraggingVolume) { e.preventDefault(); handleVolumeInput(getTouchX(e)); } }, { passive:false });
  document.addEventListener('touchend', () => { isDraggingVolume = false; }, { passive:false });

  /* 简易播放列表开关（示例） */
  listBtn.addEventListener('click', stopWrap(() => {
    playlistPanel.style.display = playlistPanel.style.display === 'block' ? 'none' : 'block';
  }));

  /* 提供给 HTML 的播放列表切换 */
  window.playIndex = function(index){ currentIndex = index; loadTrack(currentIndex); playTrack(); }

  /* 新增：封面/标题跳转到 player.html 携带参数 */
  function openPlayerPageWithData(openInNewTab = false) {
    try {
      const params = new URLSearchParams();
      params.set('course', titleEl.innerText || '');
      params.set('chapterIndex', String(currentIndex || 0));
      const safePlaylist = playlist.map((p, i) => ({
        id: p.id || ('p' + i),
        title: p.title || (`Track ${i+1}`),
        src: p.src || '',
        duration: p.durationText || p.duration || ''
      }));
      params.set('chapters', encodeURIComponent(JSON.stringify(safePlaylist)));
      const url = 'player.html?' + params.toString();
      if (openInNewTab) window.open(url, '_blank');
      else window.location.href = url;
    } catch (err) {
      try {
        const params = new URLSearchParams();
        params.set('course', titleEl.innerText || '');
        params.set('chapterIndex', String(currentIndex || 0));
        const url = 'player.html?' + params.toString();
        if (openInNewTab) window.open(url, '_blank');
        else window.location.href = url;
      } catch (_) { /* ignore */ }
    }
  }

  /* 绑定封面与标题点击事件（支持键盘） */
  if (coverEl) {
    coverEl.addEventListener('click', stopWrap(() => openPlayerPageWithData(false)));
    coverEl.addEventListener('keydown', (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); openPlayerPageWithData(false); } });
  }
  if (titleEl) {
    titleEl.addEventListener('click', stopWrap(() => openPlayerPageWithData(false)));
    titleEl.addEventListener('keydown', (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); openPlayerPageWithData(false); } });
  }

  /* 初始化第一首 */
  loadTrack(currentIndex);
})();
</script>
</body>
</html>